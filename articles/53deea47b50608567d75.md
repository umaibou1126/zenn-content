---
title: "Python Ã— Twitter API ãƒ„ã‚¤ãƒ¼ãƒˆç¨®é¡åˆ¥ã«ãƒ‡ãƒ¼ã‚¿å–å¾—ã™ã‚‹"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Python, Twitter, Django, API]
published: true
---
## ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆæ•°
### ç´¯è¨ˆã®å ´åˆ

```search.py
import tweepy
import datetime

consumer_key = ""
consumer_secret = ""
access_token = ""
access_token_secret = ""

auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)

tweets_data = []
total_tweets_data = []
keyword = 'äº”åç”°'
since = []
until = []

# æ—¥ä»˜ã‚’datetimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›´
sinceForm = '20210428'
untilForm = '20210501'
sinceDate = datetime.datetime.strptime(sinceForm, '%Y%m%d')
untilDate = datetime.datetime.strptime(
    untilForm, '%Y%m%d') + datetime.timedelta(days=1)
diff = (untilDate - sinceDate).days

# since, untilãƒªã‚¹ãƒˆã‚’ä½œæˆ
for i in range(diff):
    since.append(sinceDate + datetime.timedelta(days=i))

for i in range(diff):
    until.append(untilDate + datetime.timedelta(days=-i))
until.reverse()

# æ¤œç´¢å®Ÿè¡Œ
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=keyword,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        tweets_data.append(tweet.full_text.strip().replace('\n', 'ã€‚') + '\n')
    total_tweets_data.append(len(tweets_data))

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in total_tweets_data:
    print('-------------------------------------------')
    print(i)
```

#### å®Ÿè¡Œçµæœ
[![Image from Gyazo](https://i.gyazo.com/996544d394b1b8a4262a497a4dd6cb3c.png)](https://gyazo.com/996544d394b1b8a4262a497a4dd6cb3c)

### å½“æ—¥ã®å ´åˆ

```search.py
import tweepy
import datetime

consumer_key = ""
consumer_secret = ""
access_token = ""
access_token_secret = ""

auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)

tweets_data = []
total_tweets_data = []
day_tweets_data = []
keyword = 'äº”åç”°'
since = []
until = []

# æ—¥ä»˜ã‚’datetimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›´
sinceForm = '20210428'
untilForm = '20210501'
sinceDate = datetime.datetime.strptime(sinceForm, '%Y%m%d')
untilDate = datetime.datetime.strptime(
    untilForm, '%Y%m%d') + datetime.timedelta(days=1)
diff = (untilDate - sinceDate).days

# since, untilãƒªã‚¹ãƒˆã‚’ä½œæˆ
for i in range(diff):
    since.append(sinceDate + datetime.timedelta(days=i))

for i in range(diff):
    until.append(untilDate + datetime.timedelta(days=-i))
until.reverse()

# æ¤œç´¢å®Ÿè¡Œ
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=keyword,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        tweets_data.append(tweet.full_text.strip().replace('\n', 'ã€‚') + '\n')
    total_tweets_data.append(len(tweets_data))

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆå½“æ—¥ï¼‰
for i in range(len(total_tweets_data)):
    if i > 0:
        day_tweets_data.append(
            total_tweets_data[i] - total_tweets_data[i - 1])
    else:
        day_tweets_data.append(total_tweets_data[i])

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆå½“æ—¥ï¼‰ã‚’è¡¨ç¤º
for i in day_tweets_data:
    print('-------------------------------------------')
    print(i)
```

#### å®Ÿè¡Œçµæœ
[![Image from Gyazo](https://i.gyazo.com/3be0b25566717183a57e693085272520.png)](https://gyazo.com/3be0b25566717183a57e693085272520)

## ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€RTæ•°
### ç´¯è¨ˆã®å ´åˆ

```search.py
import tweepy
import datetime

consumer_key = ""
consumer_secret = ""
access_token = ""
access_token_secret = ""

auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)

tweets_data = []
total_tweets_data = []
day_tweets_data = []
exclude_RT_data = []
total_exclude_RT_data = []
day_exclude_RT_data = []
total_RT_data = []
day_RT_data = []
keyword = 'äº”åç”°'
key = keyword.ljust(len(keyword) + 1) + "exclude:retweets"
since = []
until = []

# æ—¥ä»˜ã‚’datetimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›´
sinceForm = '20210428'
untilForm = '20210501'
sinceDate = datetime.datetime.strptime(sinceForm, '%Y%m%d')
untilDate = datetime.datetime.strptime(
    untilForm, '%Y%m%d') + datetime.timedelta(days=1)
diff = (untilDate - sinceDate).days

# since, untilãƒªã‚¹ãƒˆã‚’ä½œæˆ
for i in range(diff):
    since.append(sinceDate + datetime.timedelta(days=i))

for i in range(diff):
    until.append(untilDate + datetime.timedelta(days=-i))
until.reverse()

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=keyword,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        tweets_data.append(tweet.full_text.strip().replace('\n', 'ã€‚') + '\n')
    total_tweets_data.append(len(tweets_data))

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ && RTã‚’é™¤ããƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=key,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        total_exclude_RT_data.append(
            tweet.full_text.strip().replace(
                '\n', 'ã€‚') + '\n')
    exclude_RT_data.append(len(total_exclude_RT_data))

# ãƒ„ã‚¤ãƒ¼ãƒˆæ•° - RTã‚’é™¤ããƒ„ã‚¤ãƒ¼ãƒˆæ•° = RTæ•°
total_RT_data = [x - y for (x, y) in zip(total_tweets_data, exclude_RT_data)]

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€RTæ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in total_RT_data:
    print('-------------------------------------------')
    print(i)
```

#### å®Ÿè¡Œçµæœ
[![Image from Gyazo](https://i.gyazo.com/c527bde9ca6cb2ad2ad0ae5077432b96.png)](https://gyazo.com/c527bde9ca6cb2ad2ad0ae5077432b96)

### å½“æ—¥ã®å ´åˆ

```search.py
import tweepy
import datetime

consumer_key = ""
consumer_secret = ""
access_token = ""
access_token_secret = ""

auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)

tweets_data = []
total_tweets_data = []
day_tweets_data = []
exclude_RT_data = []
total_exclude_RT_data = []
day_exclude_RT_data = []
total_RT_data = []
day_RT_data = []
keyword = 'äº”åç”°'
key = keyword.ljust(len(keyword) + 1) + "exclude:retweets"
since = []
until = []

# æ—¥ä»˜ã‚’datetimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›´
sinceForm = '20210428'
untilForm = '20210501'
sinceDate = datetime.datetime.strptime(sinceForm, '%Y%m%d')
untilDate = datetime.datetime.strptime(
    untilForm, '%Y%m%d') + datetime.timedelta(days=1)
diff = (untilDate - sinceDate).days

# since, untilãƒªã‚¹ãƒˆã‚’ä½œæˆ
for i in range(diff):
    since.append(sinceDate + datetime.timedelta(days=i))

for i in range(diff):
    until.append(untilDate + datetime.timedelta(days=-i))
until.reverse()

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=keyword,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        tweets_data.append(tweet.full_text.strip().replace('\n', 'ã€‚') + '\n')
    total_tweets_data.append(len(tweets_data))

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ && RTã‚’é™¤ããƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=key,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        total_exclude_RT_data.append(
            tweet.full_text.strip().replace(
                '\n', 'ã€‚') + '\n')
    exclude_RT_data.append(len(total_exclude_RT_data))

# ãƒ„ã‚¤ãƒ¼ãƒˆæ•° - RTã‚’é™¤ããƒ„ã‚¤ãƒ¼ãƒˆæ•° = RTæ•°
total_RT_data = [x - y for (x, y) in zip(total_tweets_data, exclude_RT_data)]

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€RTæ•°ï¼ˆå½“æ—¥ï¼‰
for i in range(len(total_RT_data)):
    if i > 0:
        day_RT_data.append(total_RT_data[i] - total_RT_data[i - 1])
    else:
        day_RT_data.append(total_RT_data[i])

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€RTæ•°ï¼ˆå½“æ—¥ï¼‰ã‚’è¡¨ç¤º
for i in day_RT_data:
    print('-------------------------------------------')
    print(i)
```

#### å®Ÿè¡Œçµæœ
[![Image from Gyazo](https://i.gyazo.com/d9ffe480120353db2e9f1d09a414f6a5.png)](https://gyazo.com/d9ffe480120353db2e9f1d09a414f6a5)

## ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å¼•ç”¨æ•°
### ç´¯è¨ˆã®å ´åˆ

```search.py
import tweepy
import datetime

consumer_key = ""
consumer_secret = ""
access_token = ""
access_token_secret = ""

auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)

tweets_data = []
total_tweets_data = []
day_tweets_data = []
exclude_RT_data = []
total_exclude_RT_data = []
day_exclude_RT_data = []
total_RT_data = []
day_RT_data = []
quote_data = []
total_quote_data = []
day_quote_data = []
keyword = 'äº”åç”°'
key = keyword.ljust(len(keyword) + 1) + "exclude:retweets"
since = []
until = []

# æ—¥ä»˜ã‚’datetimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›´
sinceForm = '20210428'
untilForm = '20210501'
sinceDate = datetime.datetime.strptime(sinceForm, '%Y%m%d')
untilDate = datetime.datetime.strptime(
    untilForm, '%Y%m%d') + datetime.timedelta(days=1)
diff = (untilDate - sinceDate).days

# since, untilãƒªã‚¹ãƒˆã‚’ä½œæˆ
for i in range(diff):
    since.append(sinceDate + datetime.timedelta(days=i))

for i in range(diff):
    until.append(untilDate + datetime.timedelta(days=-i))
until.reverse()

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å¼•ç”¨æ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=keyword,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        quote_data.append(tweet.is_quote_status)
    total_quote_data.append(quote_data.count(True))

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å¼•ç”¨æ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in total_quote_data:
    print('-------------------------------------------')
    print(i)
```

#### å®Ÿè¡Œçµæœ
[![Image from Gyazo](https://i.gyazo.com/1766fb0d65cc261a8b2a61d4a00cdaeb.png)](https://gyazo.com/1766fb0d65cc261a8b2a61d4a00cdaeb)

### å½“æ—¥ã®å ´åˆ

```search.py
import tweepy
import datetime

consumer_key = ""
consumer_secret = ""
access_token = ""
access_token_secret = ""

auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token, access_token_secret)
api = tweepy.API(auth)

tweets_data = []
total_tweets_data = []
day_tweets_data = []
exclude_RT_data = []
total_exclude_RT_data = []
day_exclude_RT_data = []
total_RT_data = []
day_RT_data = []
quote_data = []
total_quote_data = []
day_quote_data = []
keyword = 'äº”åç”°'
key = keyword.ljust(len(keyword) + 1) + "exclude:retweets"
since = []
until = []

# æ—¥ä»˜ã‚’datetimeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›´
sinceForm = '20210428'
untilForm = '20210501'
sinceDate = datetime.datetime.strptime(sinceForm, '%Y%m%d')
untilDate = datetime.datetime.strptime(
    untilForm, '%Y%m%d') + datetime.timedelta(days=1)
diff = (untilDate - sinceDate).days

# since, untilãƒªã‚¹ãƒˆã‚’ä½œæˆ
for i in range(diff):
    since.append(sinceDate + datetime.timedelta(days=i))

for i in range(diff):
    until.append(untilDate + datetime.timedelta(days=-i))
until.reverse()

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å¼•ç”¨æ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’è¡¨ç¤º
for i in range(diff):
    for tweet in tweepy.Cursor(
            api.search,
            tweet_mode='extended',
            q=keyword,
            lang='ja',
            since=since[i],
            until=until[i]).items():
        quote_data.append(tweet.is_quote_status)
    total_quote_data.append(quote_data.count(True))

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å¼•ç”¨æ•°ï¼ˆå½“æ—¥ï¼‰
for i in range(len(total_quote_data)):
    if i > 0:
        day_quote_data.append(total_quote_data[i] - total_quote_data[i - 1])
    else:
        day_quote_data.append(total_quote_data[i])

# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å¼•ç”¨æ•°ï¼ˆå½“æ—¥ï¼‰ã‚’è¡¨ç¤º
for i in day_quote_data:
    print('-------------------------------------------')
    print(i)
```

#### å®Ÿè¡Œçµæœ
[![Image from Gyazo](https://i.gyazo.com/d53f819fdae31bdd2963cf1831709a29.png)](https://gyazo.com/d53f819fdae31bdd2963cf1831709a29)

## å‚è€ƒæ–‡çŒ®
 - [Twitterã®Search APIã®ä½¿ã„æ–¹ã§æ··ä¹±ã—ãŸã®ã§ã¾ã¨ã‚ã¦ã¿ã‚‹](https://www.kwbtblog.com/entry/2020/01/28/045248)
 - [Twitter Rest APIã§å–å¾—ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã¾ã¨ã‚](https://syncer.jp/Web/API/Twitter/REST_API/Object/)
  - [Django + TwitterAPIã§ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹](https://note.com/yukiaofficial/n/nd56257767da2)
 - [Djangoã«Plotlyã®ã‚°ãƒ©ãƒ•ã‚’è¡¨ç¤ºã™ã‚‹](https://zenn.dev/driller/articles/6c048f953c2bc71916fb)
 - [Tweepyã§Twitterã®æ¤œç´¢, ã„ã„ã­, ãƒªãƒ„ã‚¤ãƒ¼ãƒˆ](https://qiita.com/pontyo4/items/4ef6c9cb8e15a01a3129)
 - [ã€Tweepyã€‘TwitterAPIã§ã®ãƒ‡ãƒ¼ã‚¿åé›†ã§å°‘ã—é–“é•ãˆãŸè©±](https://qiita.com/yamatia/items/455f77ee98a7f22afff0)
 - [pythonã®matplotlibã§ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¦ã¿ãŸ](https://qiita.com/robitan/items/12d2dc99edd3c31848dc)
 - [Plotlyã§ä½œã‚‹ã‚°ãƒ©ãƒ•ã‚’Djangoã§ä½¿ã†](https://qiita.com/taku_hito/items/62aeb4271614f6f0347f)
 - [[Python] Plotlyã§ãã‚Šãã‚Šå‹•ã‹ã›ã‚‹ã‚°ãƒ©ãƒ•ã‚’ä½œã‚‹](https://qiita.com/inoory/items/12028af62018bf367722)
 - [Plotlyã§æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã‚„è¤‡åˆã‚°ãƒ©ãƒ•](https://qiita.com/haru1977/items/87fba196e506f9fe225d)
 - [ã€PythonÃ—TwitterAPIã€‘Twitterã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä½œæˆã¾ã§ã®é“ã€APIã§éŠã¶ç·¨ã€‘](https://tech-blog.rakus.co.jp/entry/20201106/api)
